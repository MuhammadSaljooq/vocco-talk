const l="vocco_talk_auth_rate_limits";function a(){try{const e=localStorage.getItem(l);return e?JSON.parse(e):{}}catch(e){return console.error("Error loading rate limit data:",e),{}}}function c(e){try{localStorage.setItem(l,JSON.stringify(e))}catch(n){console.error("Error saving rate limit data:",n)}}function u(e){const n=a(),o=Date.now(),i=`login_${e.toLowerCase()}`,t=n[i]||{count:0,lastAttempt:0,lockoutUntil:0};if(t.lockoutUntil&&o<t.lockoutUntil){const s=Math.ceil((t.lockoutUntil-o)/6e4);return{allowed:!1,remainingAttempts:0,lockoutUntil:new Date(t.lockoutUntil),message:`Too many failed login attempts. Please try again in ${s} minute(s).`}}if(t.lockoutUntil&&o>=t.lockoutUntil&&(t.count=0,t.lockoutUntil=0),t.count>=5){t.lockoutUntil=o+9e5,n[i]=t,c(n);const s=Math.ceil(9e5/6e4);return{allowed:!1,remainingAttempts:0,lockoutUntil:new Date(t.lockoutUntil),message:`Too many failed login attempts. Account locked for ${s} minutes.`}}return{allowed:!0,remainingAttempts:5-t.count,lockoutUntil:t.lockoutUntil?new Date(t.lockoutUntil):null}}function m(e){const n=a(),o=Date.now(),i=`login_${e.toLowerCase()}`,t=n[i]||{count:0,lastAttempt:0,lockoutUntil:0};o-t.lastAttempt>60*60*1e3&&(t.count=0),t.count+=1,t.lastAttempt=o,t.count>=5&&(t.lockoutUntil=o+9e5),n[i]=t,c(n)}function A(e){const n=a(),o=`login_${e.toLowerCase()}`;delete n[o],c(n)}function p(e="default"){const n=a(),o=Date.now(),i=`signup_${e}`,t=n[i]||{count:0,firstAttempt:o};return o-t.firstAttempt>36e5&&(t.count=0,t.firstAttempt=o),t.count>=3?{allowed:!1,remainingAttempts:0,message:`Too many signup attempts. Please try again in ${Math.ceil((36e5-(o-t.firstAttempt))/6e4)} minute(s).`}:{allowed:!0,remainingAttempts:3-t.count}}function T(e="default"){const n=a(),o=Date.now(),i=`signup_${e}`,t=n[i]||{count:0,firstAttempt:o};o-t.firstAttempt>36e5&&(t.count=0,t.firstAttempt=o),t.count+=1,n[i]=t,c(n)}export{m as a,p as b,u as c,T as d,A as r};
